import{_ as A}from"./func-e344c7f5.js";import{d as I,r as c,a as v,c as T,b as m,e as r,w as C,f as S,F as U,o as w,g as P,t as E,p as V,h as L,N as a,i as N,_ as j}from"./index-2f4878e3.js";const R={},H=p=>(V("data-v-bbc1ff48"),p=p(),L(),p),M=H(()=>m("span",null,"Image count:",-1)),B={class:"funitem"},F={class:"funitem"},q={class:"funitem"},z={key:0},f=4,G=I({__name:"register",setup(p){const y=c([]),h=c([]),_=c(!1),g=c(""),l=c(0),u=c(0),b=async()=>{let s=f-l.value;if(s==0){a.primary("Already Done");return}document.addEventListener("deviceready",t,!1);function t(){a.primary(navigator.camera)}try{if(window.cordova){const n={quality:50,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.CAMERA,encodingType:Camera.EncodingType.JPEG,mediaType:Camera.MediaType.PICTURE};async function i(e){return new Promise((o,d)=>{navigator.camera.getPicture(o,d,e)})}for(let e=0;e<s;e++){const o=await i(n);y.value.push("data:image/jpeg;base64,"+o),l.value++}}else R.log("Cordova is not loaded")}catch(n){a.primary("Error opening camera",n)}},D=async()=>{let s=f-u.value;if(s==0){a.primary("Already Done");return}document.addEventListener("deviceready",t,!1);function t(){a.primary(navigator.camera)}try{if(window.cordova){const n={quality:50,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.CAMERA,encodingType:Camera.EncodingType.JPEG,mediaType:Camera.MediaType.PICTURE};async function i(e){return new Promise((o,d)=>{navigator.camera.getPicture(o,d,e)})}for(let e=0;e<s;e++){const o=await i(n);h.value.push("data:image/jpeg;base64,"+o),u.value++}}else R.log("Cordova is not loaded")}catch(n){a.primary("Error opening camera",n)}},k=()=>{if(g.value==""){a.warn("Please input username");return}if(l.value!=f||u.value!=f){a.warn("Please take enough photos");return}_.value=!0;let s={method:"post",url:"/register",headers:{"Content-Type":"application/json"},data:{username:g.value,left_images:y.value,right_images:h.value}};N(s).then(t=>{_.value=!1,t.data.code==0?a.success("Register Success"):a.danger("Register Failed"),l.value=0,u.value=0,y.value=[],h.value=[]}).catch(t=>{_.value=!1,a.danger(t)})};return(s,t)=>{const n=v("van-tag"),i=A,e=v("van-field"),o=v("van-cell-group"),d=v("nut-icon");return w(),T(U,null,[m("div",null,[M,r(n,{type:"primary",size:"large",class:"tag"},{default:C(()=>[P("LeftHand:"+E(l.value),1)]),_:1}),r(n,{type:"primary",size:"large"},{default:C(()=>[P("RightHand:"+E(u.value),1)]),_:1})]),m("div",B,[r(i,{msg:"LeftHand",onClick:b})]),m("div",F,[r(i,{msg:"RightHand",onClick:D})]),r(o,{inset:"",style:{"justify-content":"center",display:"flex"}},{default:C(()=>[r(e,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=x=>g.value=x),label:"Username",placeholder:"Your Username",class:"inputbox"},null,8,["modelValue"])]),_:1}),m("div",q,[r(i,{msg:"Register","background-color":"#749938","text-color":"white",onClick:k})]),_.value?(w(),T("div",z,[r(d,{name:"loading1"})])):S("",!0)],64)}}});const K=j(G,[["__scopeId","data-v-bbc1ff48"]]);export{K as default};
